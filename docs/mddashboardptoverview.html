<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>MedTrack Pro - Patient Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" onerror="console.warn('Chart.js failed to load from CDN')"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            /* Prevent text selection on mobile */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Allow text selection for content areas */
        .lab-results-table, .insight-content, .treatment-recommendations, p {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f7f4f0 0%, #ececec 100%);
            min-height: 100vh;
            color: #333;
            font-size: 16px;
            line-height: 1.6;
            /* Prevent bounce scrolling on iOS */
            -webkit-overflow-scrolling: touch;
            overflow-x: hidden;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .patient-info {
            display: grid;
            grid-template-columns: auto 1fr auto;
            align-items: center;
            gap: 20px;
        }

        .patient-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 32px;
            font-weight: bold;
        }

        .patient-details h1 {
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 32px;
            font-weight: 700;
        }

        .patient-meta {
            display: flex;
            gap: 18px;
            color: #7f8c8d;
            font-size: 16px;
        }

        .alert-badges {
            display: flex;
            gap: 10px;
            flex-direction: column;
            align-items: flex-end;
        }

        .alert {
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .alert-high { background: #ff6b6b; color: white; }
        .alert-medium { background: #ffa726; color: white; }
        .alert-info { background: #42a5f5; color: white; }

        /* Enhanced Alert System */
        .enhanced-alerts {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 20px;
            align-items: center;
            margin-top: 15px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .risk-summary {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .risk-score {
            font-size: 22px;
            font-weight: 800;
            color: #e74c3c;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .critical-values {
            font-size: 18px;
            color: #2c3e50;
            font-weight: 600;
        }

        .next-action {
            font-size: 16px;
            color: #7f8c8d;
            font-weight: 500;
        }

        /* Clinical Summary Card */
        .clinical-summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
        }

        .clinical-summary-card h3 {
            margin-bottom: 25px;
            font-size: 26px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .priority-items {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .priority-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 18px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border-left: 5px solid;
        }

        .priority-high { border-left-color: #ff6b6b; }
        .priority-medium { border-left-color: #ffa726; }
        .priority-watch { border-left-color: #42a5f5; }

        .priority-icon {
            font-size: 22px;
            min-width: 25px;
        }

        .priority-text {
            flex: 1;
            font-weight: 600;
            font-size: 18px;
        }

        .priority-status {
            font-size: 14px;
            opacity: 0.9;
            font-weight: 500;
        }

        .next-actions {
            padding: 15px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .next-actions strong {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
        }

        /* Quick Actions Bar - Sticky */
        .quick-actions-bar {
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            padding: 18px;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow-x: auto;
        }

        .quick-action-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            min-height: 44px;
        }

        .quick-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(79, 172, 254, 0.3);
        }

        .quick-action-btn.secondary {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .quick-action-btn.tertiary {
            background: linear-gradient(135deg, #f093fb, #f5576c);
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .secondary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 18px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 25px;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .card-title {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .icon {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        .lab-results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .lab-results-table th,
        .lab-results-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .lab-results-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
        }

        .value-normal {
            color: #27ae60;
            font-weight: 700;
            font-size: 16px;
        }
        .value-high {
            color: #dc2626;
            font-weight: 800;
            font-size: 16px;
            background: rgba(220, 38, 38, 0.1);
            padding: 4px 8px;
            border-radius: 6px;
            border: 2px solid #dc2626;
        }
        .value-low {
            color: #ea580c;
            font-weight: 800;
            font-size: 16px;
            background: rgba(234, 88, 12, 0.1);
            padding: 4px 8px;
            border-radius: 6px;
            border: 2px solid #ea580c;
        }

        .symptoms-grid {
            display: grid !important;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .symptom-card {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s ease;
            min-height: 120px;
            display: flex !important;
            flex-direction: column;
            justify-content: center;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .symptom-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .symptom-card:active {
            transform: scale(0.98);
        }

        /* Severity-based color coding to match the image */
        .symptom-card.severity-mild {
            background: linear-gradient(45deg, #4CAF50, #66BB6A);
        }

        .symptom-card.severity-moderate {
            background: linear-gradient(45deg, #FF9800, #FFB74D);
        }

        .symptom-card.severity-high {
            background: linear-gradient(45deg, #F44336, #EF5350);
        }

        .symptom-severity {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .symptom-card > div:nth-child(2) {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        /* Wearable Cards Styling */
        .wearable-metric-grid {
            display: grid !important;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .wearable-card {
            padding: 25px;
            border-radius: 15px;
            color: white;
            text-align: center;
            transition: transform 0.3s ease;
            min-height: 120px;
            display: flex !important;
            flex-direction: column;
            justify-content: center;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .wearable-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .wearable-card:active {
            transform: scale(0.98);
        }

        .wearable-card.sleep {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .wearable-card.steps {
            background: linear-gradient(135deg, #4CAF50, #66BB6A);
        }

        .wearable-card.heart {
            background: linear-gradient(135deg, #E91E63, #F06292);
        }

        .wearable-card.hrv {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .wearable-card.oxygen {
            background: linear-gradient(135deg, #2196F3, #64B5F6);
        }

        .wearable-card.stress {
            background: linear-gradient(135deg, #FF9800, #FFB74D);
        }

        .metric-icon {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .metric-value {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .metric-label {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .metric-change {
            font-size: 14px;
            opacity: 0.9;
        }

        /* Sleep Analysis Styling */
        .sleep-breakdown {
            margin-top: 30px;
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 12px;
        }

        .sleep-breakdown h4 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 20px;
            font-weight: 600;
        }

        .sleep-stages {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .sleep-stage {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .stage-label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 16px;
        }

        .stage-value {
            font-weight: 500;
            color: #34495e;
            font-size: 15px;
        }

        .stage-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
        }

        .stage-status.low {
            background: #ffebee;
            color: #c62828;
        }

        .stage-status.normal {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .stage-status.high {
            background: #fff3e0;
            color: #ef6c00;
        }

        .medication-list {
            list-style: none;
        }

        .medication-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .med-name {
            font-weight: 600;
            color: #2c3e50;
        }

        .med-dosage {
            color: #7f8c8d;
            font-size: 14px;
        }

        .med-date {
            color: #95a5a6;
            font-size: 12px;
            font-style: italic;
            margin-top: 3px;
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 20px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
        }

        /* Enhanced Mobile-Friendly Tab Styles */
        /* Tabs removed - now using expandable sections */

        .tabs::-webkit-scrollbar {
            display: none;
        }

        .tab {
            /* Ensure minimum touch target size for accessibility */
            min-height: 44px;
            min-width: 100px;
            padding: 14px 20px;
            cursor: pointer;
            border: 2px solid transparent;
            background: transparent;
            background-clip: padding-box;
            font-size: 16px;
            color: #2c3e50;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            backdrop-filter: blur(10px);
            white-space: nowrap;
            display: flex;
            align-items: center;
            justify-content: center;
            
            /* Touch-specific properties */
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            /* Prevent text selection */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .tab:not(.active)::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 8px;
            padding: 2px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: xor;
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            pointer-events: none;
        }

        /* Touch-friendly hover states */
        @media (hover: hover) and (pointer: fine) {
            .tab:hover {
                background: rgba(255, 255, 255, 0.8);
                color: #2c3e50;
                transform: translateY(-1px);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }
        }

        /* Touch device specific styles */
        @media (hover: none) and (pointer: coarse) {
            .tab:active {
                background: rgba(255, 255, 255, 0.9);
                transform: scale(0.98);
            }
        }

        /* Touch feedback for active state */
        .tab.active {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(245, 246, 247, 0.4);
            transform: translateY(-2px);
        }

        /* Enhanced touch feedback */
        .tab.touching {
            background: rgba(255, 255, 255, 0.9);
            transform: scale(0.98);
            transition: all 0.1s ease;
        }

        .tab.active.touching {
            background: linear-gradient(135deg, #3d8bfe, #00d2fe);
            transform: scale(0.98) translateY(-2px);
        }

        .tab-content {
            display: none !important;
        }

        .tab-content.active {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            width: 100% !important;
            height: auto !important;
            min-height: 200px !important;
            overflow: visible !important;
            position: relative !important;
            z-index: 1 !important;
        }

        .vitals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .vital-card {
            text-align: center;
            padding: 20px;
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            color: white;
            border-radius: 12px;
        }

        .vital-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .vital-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .timeline {
            position: relative;
            margin: 20px 0;
        }

        .timeline-item {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .timeline-date {
            font-weight: 600;
            color: #2c3e50;
            min-width: 100px;
        }

        .timeline-content {
            flex: 1;
            margin-left: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            transition: width 0.3s ease;
        }

        /* Enhanced Mobile Responsive Design */
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .patient-info {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 15px;
            }
            
            .alert-badges {
                align-items: center;
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
                gap: 8px;
            }

            .dashboard-container {
                padding: 15px;
            }

            .header {
                padding: 20px 15px;
            }

            .card {
                padding: 20px 15px;
            }

            /* Mobile tab adjustments */
            .tabs {
                padding: 6px;
                gap: 2px;
                margin-bottom: 15px;
            }

            .tab {
                min-width: 90px;
                padding: 12px 16px;
                font-size: 14px;
                min-height: 44px;
            }

            /* Smaller screens - stack tabs vertically if needed */
            @media (max-width: 480px) {
                .symptoms-grid {
                    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                    gap: 10px;
                }

                .vitals-grid {
                    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
                    gap: 15px;
                }

                .patient-meta {
                    flex-direction: column;
                    gap: 5px;
                    font-size: 12px;
                }

                .tabs {
                    flex-wrap: wrap;
                    max-height: 100px;
                    overflow-y: auto;
                }

                .tab {
                    flex: 1;
                    min-width: calc(50% - 4px);
                    margin-bottom: 4px;
                }
            }
        }

        /* Insights Section Styles */
        .insights-section {
            margin-top: 30px;
            padding-top: 25px;
            border-top: 2px solid #ecf0f1;
        }

        .insights-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insight-cards {
            display: grid;
            gap: 15px;
            margin-bottom: 25px;
        }

        .insight-card {
            border-radius: 10px;
            padding: 20px;
            border-left: 5px solid;
        }

        .insight-card.critical {
            background: rgba(231, 76, 60, 0.05);
            border-left-color: #e74c3c;
        }

        .insight-card.warning {
            background: rgba(243, 156, 18, 0.05);
            border-left-color: #f39c12;
        }

        .insight-card.info {
            background: rgba(52, 152, 219, 0.05);
            border-left-color: #3498db;
        }

        .insight-header {
            font-weight: 600;
            font-size: 16px;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .insight-content p {
            margin-bottom: 8px;
            font-size: 14px;
            line-height: 1.5;
        }

        .treatment-recommendations {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #27ae60;
        }

        .treatment-recommendations h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .treatment-recommendations ul {
            list-style: none;
            padding: 0;
        }

        .treatment-recommendations li {
            margin-bottom: 12px;
            padding-left: 20px;
            position: relative;
            font-size: 14px;
            line-height: 1.5;
        }

        .treatment-recommendations li::before {
            content: "‚Ä¢";
            color: #27ae60;
            font-weight: bold;
            position: absolute;
            left: 0;
        }

        /* Wearables Styles */
        .wearables-overview {
            margin-bottom: 25px;
        }



        .wearable-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .wearable-card:hover {
            transform: translateY(-2px);
        }

        .wearable-card.sleep { background: linear-gradient(135deg, #4e54c8, #8f94fb); }
        .wearable-card.steps { background: linear-gradient(135deg, #11998e, #38ef7d); }
        .wearable-card.heart { background: linear-gradient(135deg, #fc466b, #3f5efb); }
        .wearable-card.hrv { background: linear-gradient(135deg, #3b41c5, #a981bb); }
        .wearable-card.oxygen { background: linear-gradient(135deg, #209cff, #68e0cf); }
        .wearable-card.stress { background: linear-gradient(135deg, #ff9966, #ff5e62); }

        .metric-icon {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .metric-value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .metric-change {
            font-size: 12px;
            font-weight: 600;
        }

        .metric-change.up { color: #ffeb3b; }
        .metric-change.down { color: #ff8a80; }
        .metric-change.stable { color: #a5d6a7; }

        .sleep-breakdown {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .sleep-breakdown h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .sleep-stages {
            display: grid;
            gap: 10px;
        }

        .sleep-stage {
            display: grid;
            grid-template-columns: 120px 1fr auto;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            font-size: 14px;
        }

        .stage-label {
            font-weight: 600;
            color: #2c3e50;
        }

        .stage-value {
            color: #7f8c8d;
        }

        .stage-status {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        .stage-status.normal { background: #d4edda; color: #155724; }
        .stage-status.low { background: #fff3cd; color: #856404; }
        .stage-status.high { background: #f8d7da; color: #721c24; }

        /* Trends Insights Styles */
        .trends-insights-section {
            margin-top: 30px;
            padding-top: 25px;
            border-top: 2px solid #ecf0f1;
        }

        .trends-insight-cards {
            display: grid;
            gap: 15px;
            margin-bottom: 25px;
        }

        .prognosis-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .prognosis-section h4 {
            color: white;
            margin-bottom: 20px;
            font-size: 18px;
        }

        .prognosis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .prognosis-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .prognosis-item strong {
            display: block;
            margin-bottom: 10px;
            font-size: 16px;
            color: #ffffff;
        }

        .prognosis-item p {
            font-size: 14px;
            line-height: 1.5;
            color: rgba(255, 255, 255, 0.9);
        }

        /* Critical Values Summary */
        .critical-values-summary {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 16px rgba(255, 107, 107, 0.3);
        }

        .critical-values-summary h4 {
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .critical-values-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .critical-value-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .critical-value-item .value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .critical-value-item .label {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 3px;
        }

        .critical-value-item .trend {
            font-size: 11px;
            opacity: 0.8;
        }

        /* Expandable Sections */
        .expandable-section {
            margin-top: 20px;
        }

        .expand-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 20px;
            background: #f8f9fa;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            transition: all 0.3s ease;
        }

        .expand-toggle:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        .expand-toggle.active {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
        }

        .expand-icon {
            transition: transform 0.3s ease;
        }

        .expand-toggle.active .expand-icon {
            transform: rotate(180deg);
        }

        .expandable-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .expandable-content.active {
            max-height: 2000px;
        }

        .expandable-content-inner {
            padding: 20px 0;
        }

        /* Enhanced Typography for Critical Info */
        .critical-info {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
        }

        .supporting-info {
            font-size: 14px;
            color: #7f8c8d;
            margin-top: 5px;
        }

        /* Color-coded Severity Indicators */
        .severity-critical {
            border-left: 5px solid #e74c3c;
            background: rgba(231, 76, 60, 0.05);
        }

        .severity-warning {
            border-left: 5px solid #f39c12;
            background: rgba(243, 156, 18, 0.05);
        }

        .severity-normal {
            border-left: 5px solid #27ae60;
            background: rgba(39, 174, 96, 0.05);
        }

        /* Mobile Responsive Enhancements */
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }

            .secondary-grid {
                grid-template-columns: 1fr;
            }

            .enhanced-alerts {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .critical-values-grid {
                grid-template-columns: 1fr;
            }

            .quick-actions-bar {
                flex-wrap: wrap;
                gap: 10px;
                padding: 15px;
            }

            .quick-action-btn {
                flex: 1;
                min-width: calc(50% - 5px);
                font-size: 15px;
            }

            .priority-items {
                gap: 10px;
            }

            .priority-item {
                padding: 12px 15px;
            }

            .dashboard-container {
                padding: 18px;
            }

            .card {
                padding: 25px;
            }

            .patient-details h1 {
                font-size: 28px;
            }

            .patient-meta {
                font-size: 14px;
                gap: 12px;
            }
        }
    </style>
    
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <div class="patient-info">
                <div class="patient-avatar">SM</div>
                <div class="patient-details">
                    <h1>Sarah Mitchell</h1>
                    <div class="patient-meta">
                        <span>DOB: March 15, 1985 (39 years)</span>
                        <span>‚Ä¢</span>
                        <span>ID: PM-2024-7891</span>
                        <span>‚Ä¢</span>
                        <span>Last Visit: July 25, 2025</span>
                    </div>
                </div>
                <div class="alert-badges">
                    <div class="alert alert-high">High Cholesterol</div>
                    <div class="alert alert-medium">Iron Deficiency</div>
                    <div class="alert alert-info">Monitoring</div>
                </div>
            </div>

            <!-- Enhanced Alert System -->
            <div class="enhanced-alerts">
                <div class="risk-summary">
                    <div class="risk-score">
                        üö® High Risk - 3 Active Concerns
                    </div>
                    <div class="critical-values">
                        Critical Values: Hgb 10.8 ‚Üì | Ferritin 8 ‚Üì | Chol 248 ‚Üë
                    </div>
                    <div class="next-action">
                        Next Action Required: Follow-up Labs Due in 2-4 weeks
                    </div>
                </div>
            </div>
        </div>

        <!-- Clinical Priority Summary -->
        <div class="clinical-summary-card">
            <h3>
                <svg class="icon" viewBox="0 0 24 24" style="fill: white;">
                    <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,17A1.5,1.5 0 0,0 10.5,15.5A1.5,1.5 0 0,0 12,14A1.5,1.5 0 0,0 13.5,15.5A1.5,1.5 0 0,0 12,17M12,4A6,6 0 0,0 6,10C6,10 6,10.5 6.5,11H9V12.5H8.5C8,12.5 7.5,12.85 7.5,13.5V16H10.5V13.5H11.5V16H16.5V13.5C16.5,12.85 16,12.5 15.5,12.5H15V11H17.5C18,10.5 18,10 18,10A6,6 0 0,0 12,4Z"/>
                </svg>
                Clinical Priority Summary
            </h3>
            <div class="priority-items">
                <div class="priority-item priority-high">
                    <div class="priority-icon">ü©∏</div>
                    <div class="priority-text">Iron Deficiency Anemia - Treatment Day 8</div>
                    <div class="priority-status">Monitoring Response</div>
                </div>
                <div class="priority-item priority-medium">
                    <div class="priority-icon">‚ù§Ô∏è</div>
                    <div class="priority-text">Hypercholesterolemia - Statin Resistance</div>
                    <div class="priority-status">Needs Adjustment</div>
                </div>
                <div class="priority-item priority-watch">
                    <div class="priority-icon">üîç</div>
                    <div class="priority-text">Joint Pain - Needs Investigation</div>
                    <div class="priority-status">Consider Workup</div>
                </div>
            </div>
            <div class="next-actions">
                <strong>Immediate Next Actions:</strong>
                CBC & Iron Studies in 2-4 weeks | Consider Statin Dose Adjustment | Inflammatory Markers Workup
            </div>

            <!-- Differential Diagnosis Table -->
            <div style="margin-top: 25px; padding: 0;">
                <h4 style="color: white; margin-bottom: 20px; font-size: 20px; font-weight: 600;">üî¨ Differential Diagnosis</h4>
                <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; color: #2c3e50;">
                        <thead>
                            <tr style="border-bottom: 2px solid #e0e6ed;">
                                <th style="padding: 12px; text-align: left; font-size: 16px; font-weight: 600; color: #2c3e50;">Condition</th>
                                <th style="padding: 12px; text-align: left; font-size: 16px; font-weight: 600; color: #2c3e50;">Likelihood</th>
                                <th style="padding: 12px; text-align: left; font-size: 16px; font-weight: 600; color: #2c3e50;">Supporting Evidence</th>
                                <th style="padding: 12px; text-align: left; font-size: 16px; font-weight: 600; color: #2c3e50;">Confirmatory Tests</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid #f1f3f4;">
                                <td style="padding: 12px; font-size: 15px; font-weight: 500; color: #2c3e50;">Iron Deficiency Anemia</td>
                                <td style="padding: 12px; font-size: 15px;"><span style="background: #27ae60; color: white; padding: 4px 8px; border-radius: 4px; font-weight: 600;">High</span></td>
                                <td style="padding: 12px; font-size: 14px; color: #34495e;">Low Hgb, Ferritin, Iron; Fatigue symptoms</td>
                                <td style="padding: 12px; font-size: 14px; color: #34495e;">TIBC, Transferrin Saturation, Reticulocyte count</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #f1f3f4;">
                                <td style="padding: 12px; font-size: 15px; font-weight: 500; color: #2c3e50;">Chronic GI Blood Loss</td>
                                <td style="padding: 12px; font-size: 15px;"><span style="background: #f39c12; color: white; padding: 4px 8px; border-radius: 4px; font-weight: 600;">Moderate</span></td>
                                <td style="padding: 12px; font-size: 14px; color: #34495e;">Progressive iron deficiency, no dietary cause</td>
                                <td style="padding: 12px; font-size: 14px; color: #34495e;">Colonoscopy, Upper endoscopy, Fecal occult blood</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #f1f3f4;">
                                <td style="padding: 12px; font-size: 15px; font-weight: 500; color: #2c3e50;">Inflammatory Arthritis</td>
                                <td style="padding: 12px; font-size: 15px;"><span style="background: #f39c12; color: white; padding: 4px 8px; border-radius: 4px; font-weight: 600;">Moderate</span></td>
                                <td style="padding: 12px; font-size: 14px; color: #34495e;">Joint pain 7/10, worsening pattern</td>
                                <td style="padding: 12px; font-size: 14px; color: #34495e;">ESR, CRP, RF, Anti-CCP, ANA, X-rays</td>
                            </tr>
                            <tr style="border-bottom: 1px solid #f1f3f4;">
                                <td style="padding: 12px; font-size: 15px; font-weight: 500; color: #2c3e50;">Familial Hypercholesterolemia</td>
                                <td style="padding: 12px; font-size: 15px;"><span style="background: #e74c3c; color: white; padding: 4px 8px; border-radius: 4px; font-weight: 600;">Low</span></td>
                                <td style="padding: 12px; font-size: 14px; color: #34495e;">Statin resistance, elevated cholesterol</td>
                                <td style="padding: 12px; font-size: 14px; color: #34495e;">Lipid panel, Family history, Genetic testing</td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; font-size: 15px; font-weight: 500; color: #2c3e50;">Hypothyroidism</td>
                                <td style="padding: 12px; font-size: 15px;"><span style="background: #e74c3c; color: white; padding: 4px 8px; border-radius: 4px; font-weight: 600;">Low</span></td>
                                <td style="padding: 12px; font-size: 14px; color: #34495e;">Fatigue, elevated cholesterol</td>
                                <td style="padding: 12px; font-size: 14px; color: #34495e;">TSH, Free T4, Free T3</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Quick Actions Bar -->
        <div class="quick-actions-bar">
            <button class="quick-action-btn">
                <svg class="icon" viewBox="0 0 24 24" style="width: 16px; height: 16px; fill: currentColor;">
                    <path d="M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3"/>
                </svg>
                Order Labs
            </button>
            <button class="quick-action-btn secondary">
                <svg class="icon" viewBox="0 0 24 24" style="width: 16px; height: 16px; fill: currentColor;">
                    <path d="M6.5,20.5L17.5,9.5C18.28,8.72 18.28,7.47 17.5,6.69L12.31,1.5C11.53,0.72 10.28,0.72 9.5,1.5L8.5,2.5L11.5,5.5L10.09,6.91L7.09,3.91L6.09,4.91L9.09,7.91L7.68,9.32L4.68,6.32L3.68,7.32L6.68,10.32L5.27,11.73L2.27,8.73L1.27,9.73L4.27,12.73L2.86,14.14L5.86,17.14L14.14,8.86L17.14,11.86L18.55,10.45L6.5,20.5Z"/>
                </svg>
                Prescribe
            </button>
            <button class="quick-action-btn tertiary">
                <svg class="icon" viewBox="0 0 24 24" style="width: 16px; height: 16px; fill: currentColor;">
                    <path d="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"/>
                </svg>
                Schedule Follow-up
            </button>
            <button class="quick-action-btn">
                <svg class="icon" viewBox="0 0 24 24" style="width: 16px; height: 16px; fill: currentColor;">
                    <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                </svg>
                Voice Notes
            </button>
        </div>

        <!-- Main Content Grid -->
        <div class="main-grid">
            <!-- Primary Tab Content - Full Width -->
            <div class="card">
                <!-- Lab Results Section (Always Visible) -->
                <div id="lab-results" class="lab-results-section">
                    <div class="card-title">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3"/>
                        </svg>
                        Lab Results Overview - July 28, 2025
                    </div>

                    <!-- Critical Values Summary -->
                    <div class="critical-values-summary">
                        <h4>
                            üö® Critical Values Requiring Immediate Attention
                        </h4>
                        <div class="critical-values-grid">
                            <div class="critical-value-item">
                                <div class="value">10.8</div>
                                <div class="label">Hemoglobin (g/dL)</div>
                                <div class="trend">‚Üì Declining - Anemia</div>
                            </div>
                            <div class="critical-value-item">
                                <div class="value">8</div>
                                <div class="label">Ferritin (ng/mL)</div>
                                <div class="trend">‚Üì Critically Low</div>
                            </div>
                            <div class="critical-value-item">
                                <div class="value">248</div>
                                <div class="label">Total Cholesterol (mg/dL)</div>
                                <div class="trend">‚Üë 24% Above Target</div>
                            </div>
                            <div class="critical-value-item">
                                <div class="value">45</div>
                                <div class="label">Iron (Œºg/dL)</div>
                                <div class="trend">‚Üì Below Normal</div>
                            </div>
                        </div>
                    </div>

                    <!-- Treatment Response Indicators -->
                    <div class="severity-warning" style="padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <div class="critical-info">Iron Therapy Response - Day 8</div>
                        <div class="supporting-info">Patient started on Iron Sulfate 325mg daily on July 20th. Expect symptom improvement in 2-4 weeks, lab improvement in 4-6 weeks.</div>
                    </div>

                    <!-- Expandable Detailed Lab Results -->
                    <div class="expandable-section">
                        <button class="expand-toggle" onclick="toggleExpand('detailed-labs')">
                            <span>Complete Lab Results (CBC) - July 28, 2025</span>
                            <svg class="expand-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/>
                            </svg>
                        </button>
                        <div class="expandable-content" id="detailed-labs">
                            <div class="expandable-content-inner">
                                <table class="lab-results-table">
                        <thead>
                            <tr>
                                <th>Test</th>
                                <th>Result</th>
                                <th>Normal Range</th>
                                <th>Status</th>
                                <th>Trend</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>White Blood Cells</td>
                                <td class="value-normal">7.2 K/ŒºL</td>
                                <td>4.0-11.0 K/ŒºL</td>
                                <td>Normal</td>
                                <td>‚Üí Stable</td>
                            </tr>
                            <tr>
                                <td>Red Blood Cells</td>
                                <td class="value-normal">4.1 M/ŒºL</td>
                                <td>3.8-5.2 M/ŒºL</td>
                                <td>Normal</td>
                                <td>‚Üì Slight decline</td>
                            </tr>
                            <tr>
                                <td>Hemoglobin</td>
                                <td class="value-low">10.8 g/dL</td>
                                <td>12.0-16.0 g/dL</td>
                                <td>Low ‚ö†Ô∏è</td>
                                <td>‚Üì Declining</td>
                            </tr>
                            <tr>
                                <td>Hematocrit</td>
                                <td class="value-low">32.1%</td>
                                <td>36.0-48.0%</td>
                                <td>Low ‚ö†Ô∏è</td>
                                <td>‚Üì Declining</td>
                            </tr>
                            <tr>
                                <td>Platelets</td>
                                <td class="value-normal">285 K/ŒºL</td>
                                <td>150-450 K/ŒºL</td>
                                <td>Normal</td>
                                <td>‚Üí Stable</td>
                            </tr>
                            <tr>
                                <td>Total Cholesterol</td>
                                <td class="value-high">248 mg/dL</td>
                                <td>&lt;200 mg/dL</td>
                                <td>High üö®</td>
                                <td>‚Üë Rising</td>
                            </tr>
                            <tr>
                                <td>Iron</td>
                                <td class="value-low">45 Œºg/dL</td>
                                <td>60-170 Œºg/dL</td>
                                <td>Low ‚ö†Ô∏è</td>
                                <td>‚Üì Declining</td>
                            </tr>
                            <tr>
                                <td>Ferritin</td>
                                <td class="value-low">8 ng/mL</td>
                                <td>15-150 ng/mL</td>
                                <td>Low ‚ö†Ô∏è</td>
                                <td>‚Üì Critically low</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Clinical Insights Section -->
                    <div class="insights-section">
                        <h3 class="insights-title">
                            <svg class="icon" viewBox="0 0 24 24">
                                <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,17A1.5,1.5 0 0,0 10.5,15.5A1.5,1.5 0 0,0 12,14A1.5,1.5 0 0,0 13.5,15.5A1.5,1.5 0 0,0 12,17M12,4A6,6 0 0,0 6,10C6,10 6,10.5 6.5,11H9V12.5H8.5C8,12.5 7.5,12.85 7.5,13.5V16H10.5V13.5H11.5V16H16.5V13.5C16.5,12.85 16,12.5 15.5,12.5H15V11H17.5C18,10.5 18,10 18,10A6,6 0 0,0 12,4Z"/>
                            </svg>
                            Clinical Insights & Symptom-Lab Correlation
                        </h3>
                        
                        <div class="insight-cards">
                            <div class="insight-card critical">
                                <div class="insight-header">ü©∏ Iron Deficiency Anemia - CONFIRMED</div>
                                <div class="insight-content">
                                    <p><strong>Lab Evidence:</strong> Low Hemoglobin (10.8), Hematocrit (32.1%), Iron (45), Ferritin (8)</p>
                                    <p><strong>Supporting Symptoms:</strong> Fatigue (6/10, increasing), Dizziness (3/10), correlating with declining lab values</p>
                                    <p><strong>Wearable Data:</strong> Decreased step count (-22%), increased resting HR (+8 bpm), poor sleep quality</p>
                                </div>
                            </div>
                            
                            <div class="insight-card warning">
                                <div class="insight-header">‚ù§Ô∏è Hypercholesterolemia - REQUIRES ATTENTION</div>
                                <div class="insight-content">
                                    <p><strong>Lab Evidence:</strong> Total Cholesterol 248 mg/dL (24% above target)</p>
                                    <p><strong>Current Treatment:</strong> Atorvastatin 20mg (started May 2025) - may need dose adjustment</p>
                                    <p><strong>Lifestyle Impact:</strong> Reduced activity levels may be contributing to lipid elevation</p>
                                </div>
                            </div>
                            
                            <div class="insight-card info">
                                <div class="insight-header">üîç Inflammatory Markers - MONITORING</div>
                                <div class="insight-content">
                                    <p><strong>Symptom Pattern:</strong> Joint pain (7/10, worsening) without clear lab inflammation markers</p>
                                    <p><strong>Recommendation:</strong> Consider ESR, CRP, and rheumatologic panel</p>
                                    <p><strong>Activity Impact:</strong> 35% reduction in active minutes, may be pain-related</p>
                                </div>
                            </div>
                        </div>

                        <div class="treatment-recommendations">
                            <h4>üìã Recommended Actions</h4>
                            <ul>
                                <li><strong>Iron Therapy Monitoring:</strong> Current therapy started Jul 20 (8 days ago) - continue current dose and reassess in 4-6 weeks to determine whether increase is needed</li>
                                <li><strong>Cholesterol Management:</strong> Evaluate atorvastatin effectiveness, consider lifestyle counseling</li>
                                <li><strong>Activity Monitoring:</strong> Gradual increase in activity as anemia improves</li>
                                <li><strong>Follow-up Labs:</strong> Repeat CBC, iron studies in 4-6 weeks</li>
                            </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Symptom Tracking Expandable Section -->
                <div class="expandable-section">
                    <button class="expand-toggle" onclick="toggleExpand('symptom-tracking')">
                        <span>
                            <svg class="icon" viewBox="0 0 24 24" style="margin-right: 10px;">
                                <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9Z"/>
                            </svg>
                            Current Symptoms - Last 7 Days
                        </span>
                        <svg class="expand-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/>
                        </svg>
                    </button>
                    <div class="expandable-content" id="symptom-tracking">
                        <div class="expandable-content-inner">
                            <div class="symptoms-grid">
                                <div class="symptom-card severity-moderate">
                                    <div class="symptom-severity">6/10</div>
                                    <div>Fatigue</div>
                                    <div style="font-size: 14px; opacity: 0.9; margin-top: 8px;">‚Üë Increasing</div>
                                </div>
                                <div class="symptom-card severity-mild">
                                    <div class="symptom-severity">4/10</div>
                                    <div>Headaches</div>
                                    <div style="font-size: 14px; opacity: 0.9; margin-top: 8px;">‚Üí Stable</div>
                                </div>
                                <div class="symptom-card severity-mild">
                                    <div class="symptom-severity">3/10</div>
                                    <div>Dizziness</div>
                                    <div style="font-size: 14px; opacity: 0.9; margin-top: 8px;">‚Üì Improving</div>
                                </div>
                                <div class="symptom-card severity-high">
                                    <div class="symptom-severity">7/10</div>
                                    <div>Joint Pain</div>
                                    <div style="font-size: 14px; opacity: 0.9; margin-top: 8px;">‚Üë Worsening</div>
                                </div>
                            </div>

                            <!-- Symptom Trends Chart -->
                            <div class="chart-container" style="margin-top: 30px;">
                                <canvas id="symptomsChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Wearables Data Expandable Section -->
                <div class="expandable-section">
                    <button class="expand-toggle" onclick="toggleExpand('wearables-data')">
                        <span>
                            <svg class="icon" viewBox="0 0 24 24" style="margin-right: 10px;">
                                <path d="M20.1,7L23,9.2L21.8,10.6L19.3,8.5L19.4,7H20.1M4.8,6.8L7.3,8.5L6.2,10.1L3.2,7.9L4.8,6.8M12.5,1H11.5V4H12.5V1M21,13H24V12H21V13M0,13H3V12H0V13M6,20H18A2,2 0 0,1 20,22H4A2,2 0 0,1 6,20M8,22H16V23H8V22Z"/>
                            </svg>
                            Wearable Device Data - Last 7 Days
                        </span>
                        <svg class="expand-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/>
                        </svg>
                    </button>
                    <div class="expandable-content" id="wearables-data">
                        <div class="expandable-content-inner">
                            <div class="wearables-overview">
                                <div class="wearable-metric-grid">
                                    <div class="wearable-card sleep">
                                        <div class="metric-icon">üõå</div>
                                        <div class="metric-value">5.2 hrs</div>
                                        <div class="metric-label">Avg Sleep</div>
                                        <div class="metric-change down">‚Üì -1.3 hrs vs baseline</div>
                                    </div>
                                    <div class="wearable-card steps">
                                        <div class="metric-icon">üëü</div>
                                        <div class="metric-value">4,650</div>
                                        <div class="metric-label">Daily Steps</div>
                                        <div class="metric-change down">‚Üì -22% vs target</div>
                                    </div>
                                    <div class="wearable-card heart">
                                        <div class="metric-icon">‚ù§Ô∏è</div>
                                        <div class="metric-value">78 bpm</div>
                                        <div class="metric-label">Resting HR</div>
                                        <div class="metric-change up">‚Üë +8 bpm vs baseline</div>
                                    </div>
                                    <div class="wearable-card hrv">
                                        <div class="metric-icon">üìä</div>
                                        <div class="metric-value">28 ms</div>
                                        <div class="metric-label">HRV</div>
                                        <div class="metric-change down">‚Üì Low variability</div>
                                    </div>
                                    <div class="wearable-card oxygen">
                                        <div class="metric-icon">üîµ</div>
                                        <div class="metric-value">97%</div>
                                        <div class="metric-label">SpO2</div>
                                        <div class="metric-change stable">‚Üí Normal range</div>
                                    </div>
                                    <div class="wearable-card stress">
                                        <div class="metric-icon">‚ö°</div>
                                        <div class="metric-value">High</div>
                                        <div class="metric-label">Stress Level</div>
                                        <div class="metric-change up">‚Üë Above normal</div>
                                    </div>
                                </div>
                            </div>

                            <div class="sleep-breakdown">
                                <h4>Sleep Quality Analysis</h4>
                                <div class="sleep-stages">
                                    <div class="sleep-stage">
                                        <span class="stage-label">Deep Sleep:</span>
                                        <span class="stage-value">45 min (14%)</span>
                                        <span class="stage-status low">Below optimal</span>
                                    </div>
                                    <div class="sleep-stage">
                                        <span class="stage-label">REM Sleep:</span>
                                        <span class="stage-value">68 min (22%)</span>
                                        <span class="stage-status normal">Normal</span>
                                    </div>
                                    <div class="sleep-stage">
                                        <span class="stage-label">Light Sleep:</span>
                                        <span class="stage-value">3.2 hrs (64%)</span>
                                        <span class="stage-status high">High proportion</span>
                                    </div>
                                </div>
                            </div>

                            <div class="chart-container">
                                <canvas id="wearablesChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
        </div>

        <!-- Secondary Content Grid -->
        <div class="secondary-grid">
                <!-- Current Medications -->
                <div class="card">
                    <!-- Medication Summary (Always Visible) -->
                    <div class="severity-warning" style="padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                        <div class="critical-info">üíä Active Medications: 4 Total</div>
                        <div class="supporting-info">Iron Therapy (Day 8) | Statin Therapy | PRN Pain Management</div>
                    </div>

                    <!-- Expandable Detailed Medications -->
                    <div class="expandable-section">
                        <button class="expand-toggle" onclick="toggleExpand('detailed-medications')">
                            <span>
                                <svg class="icon" viewBox="0 0 24 24" style="margin-right: 10px;">
                                    <path d="M6.5,20.5L17.5,9.5C18.28,8.72 18.28,7.47 17.5,6.69L12.31,1.5C11.53,0.72 10.28,0.72 9.5,1.5L8.5,2.5L11.5,5.5L10.09,6.91L7.09,3.91L6.09,4.91L9.09,7.91L7.68,9.32L4.68,6.32L3.68,7.32L6.68,10.32L5.27,11.73L2.27,8.73L1.27,9.73L4.27,12.73L2.86,14.14L5.86,17.14L14.14,8.86L17.14,11.86L18.55,10.45L6.5,20.5Z"/>
                                </svg>
                                Current Medications - Detailed List
                            </span>
                            <svg class="expand-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/>
                            </svg>
                        </button>
                        <div class="expandable-content" id="detailed-medications">
                            <div class="expandable-content-inner">
                                <ul class="medication-list">
                                    <li class="medication-item">
                                        <div>
                                            <div class="med-name">Iron Sulfate 325mg</div>
                                            <div class="med-dosage">Once daily with food</div>
                                            <div class="med-date">Started: Jul 20, 2025</div>
                                        </div>
                                    </li>
                                    <li class="medication-item">
                                        <div>
                                            <div class="med-name">Atorvastatin 20mg</div>
                                            <div class="med-dosage">Once daily at bedtime</div>
                                            <div class="med-date">Started: May 15, 2025</div>
                                        </div>
                                    </li>
                                    <li class="medication-item">
                                        <div>
                                            <div class="med-name">Multivitamin</div>
                                            <div class="med-dosage">Once daily with breakfast</div>
                                            <div class="med-date">Started: Jan 10, 2025</div>
                                        </div>
                                    </li>
                                    <li class="medication-item">
                                        <div>
                                            <div class="med-name">Ibuprofen 400mg</div>
                                            <div class="med-dosage">As needed for joint pain</div>
                                            <div class="med-date">Started: Jul 25, 2025</div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Vital Signs -->
                <div class="card">
                    <!-- Vitals Summary (Always Visible) -->
                    <div class="severity-normal" style="padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                        <div class="critical-info">üìä Recent Vitals: All Normal</div>
                        <div class="supporting-info">BP: 118/75 | HR: 72 | Temp: 98.6¬∞F | O2: 98%</div>
                    </div>

                    <!-- Expandable Detailed Vitals -->
                    <div class="expandable-section">
                        <button class="expand-toggle" onclick="toggleExpand('detailed-vitals')">
                            <span>
                                <svg class="icon" viewBox="0 0 24 24" style="margin-right: 10px;">
                                    <path d="M19,14H15A3,3 0 0,1 12,11A3,3 0 0,1 15,8H19A1,1 0 0,1 20,9V13A1,1 0 0,1 19,14M15,10A1,1 0 0,0 14,11A1,1 0 0,0 15,12A1,1 0 0,0 16,11A1,1 0 0,0 15,10M12.5,2C13,2 13.5,2.17 13.9,2.45L21.6,8.82C22.08,9.21 22.39,9.76 22.5,10.37C22.61,11 22.5,11.64 22.17,12.22L17.63,20.29C17.25,20.93 16.61,21.36 15.87,21.5C15.13,21.64 14.37,21.47 13.77,21.05L7.45,16.8C6.85,16.38 6.5,15.73 6.5,15.04V9.96C6.5,9.27 6.85,8.62 7.45,8.2L13.77,3.95C14.12,3.73 14.56,3.61 15,3.61C15.44,3.61 15.88,3.73 16.23,3.95L18.4,5.5L12.5,2M15,5L12,8H15A2,2 0 0,1 17,10A2,2 0 0,1 15,12H12L15,15H19L15,5Z"/>
                                </svg>
                                Recent Vitals - Detailed View
                            </span>
                            <svg class="expand-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/>
                            </svg>
                        </button>
                        <div class="expandable-content" id="detailed-vitals">
                            <div class="expandable-content-inner">
                                <div class="vitals-grid">
                                    <div class="vital-card">
                                        <div class="vital-value">118/75</div>
                                        <div class="vital-label">BP (mmHg)</div>
                                    </div>
                                    <div class="vital-card">
                                        <div class="vital-value">72</div>
                                        <div class="vital-label">Heart Rate</div>
                                    </div>
                                    <div class="vital-card">
                                        <div class="vital-value">98.6¬∞F</div>
                                        <div class="vital-label">Temperature</div>
                                    </div>
                                    <div class="vital-card">
                                        <div class="vital-value">98%</div>
                                        <div class="vital-label">O2 Sat</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Treatment Timeline - Full Width -->
        <div class="card">
            <!-- Timeline Summary (Always Visible) -->
            <div class="severity-normal" style="padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                <div class="critical-info">üìÖ Recent Activity: 4 Events (13 Days)</div>
                <div class="supporting-info">Latest: Lab Results (Jul 28) | Iron Therapy Started (Jul 20) | Clinical Visit (Jul 25)</div>
            </div>

            <!-- Expandable Detailed Timeline -->
            <div class="expandable-section">
                <button class="expand-toggle" onclick="toggleExpand('detailed-timeline')">
                    <span>
                        <svg class="icon" viewBox="0 0 24 24" style="margin-right: 10px;">
                            <path d="M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"/>
                        </svg>
                        Treatment Timeline - Detailed History
                    </span>
                    <svg class="expand-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/>
                    </svg>
                </button>
                <div class="expandable-content" id="detailed-timeline">
                    <div class="expandable-content-inner">
                        <div class="timeline">
                            <div class="timeline-item">
                                <div class="timeline-date">Jul 28, 2025</div>
                                <div class="timeline-content">
                                    <strong>Lab Results Received</strong>
                                    <p>CBC shows iron deficiency anemia and elevated cholesterol. Hemoglobin 10.8 g/dL, Ferritin 8 ng/mL, Total Cholesterol 248 mg/dL</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 100%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-date">Jul 25, 2025</div>
                                <div class="timeline-content">
                                    <strong>Clinical Visit</strong>
                                    <p>Patient reports increased fatigue and joint pain. Wearable data shows declining activity levels and sleep quality</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 85%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-date">Jul 20, 2025</div>
                                <div class="timeline-content">
                                    <strong>Medication Started</strong>
                                    <p>Iron sulfate 325mg daily prescribed for suspected iron deficiency anemia</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 70%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-date">Jul 15, 2025</div>
                                <div class="timeline-content">
                                    <strong>Symptom Tracking Started</strong>
                                    <p>Patient enrolled in daily symptom monitoring and wearable device integration activated</p>
                                    <div class="progress-bar">
                                        <div class="progress-fill" style="width: 60%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Health Trends Section -->
        <div class="card">
            <div class="expandable-section">
                <button class="expand-toggle" onclick="toggleExpand('health-trends')">
                    <span>
                        <svg class="icon" viewBox="0 0 24 24" style="margin-right: 10px;">
                            <path d="M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"/>
                        </svg>
                        Health Trends - 6 Month Longitudinal Analysis
                    </span>
                    <svg class="expand-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"/>
                    </svg>
                </button>
                <div class="expandable-content" id="health-trends">
                    <div class="expandable-content-inner">
                        <div class="chart-container">
                            <canvas id="trendsChart"></canvas>
                        </div>

                        <!-- Trends-Specific Clinical Insights -->
                        <div class="trends-insights-section">
                            <h3 class="insights-title">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V4C4,2.89 4.89,2 6,2M15,18V16H6V18H15M18,14V12H6V14H18Z"/>
                                </svg>
                                Longitudinal Analysis & Treatment Response
                            </h3>

                            <div class="trends-insight-cards">
                                <div class="insight-card critical">
                                    <div class="insight-header">üìâ Progressive Iron Deficiency - CHRONIC PATTERN</div>
                                    <div class="insight-content">
                                        <p><strong>6-Month Decline:</strong> Hemoglobin ‚Üì18% (12.1‚Üí10.8), Iron ‚Üì31% (65‚Üí45 Œºg/dL)</p>
                                        <p><strong>Clinical Significance:</strong> Consistent monthly decline suggests ongoing blood loss or malabsorption, not acute event</p>
                                        <p><strong>Treatment Response:</strong> Iron therapy started Jul 20 - need 4-6 week follow-up to assess efficacy</p>
                                    </div>
                                </div>

                                <div class="insight-card warning">
                                    <div class="insight-header">üìà Accelerating Cardiovascular Risk</div>
                                    <div class="insight-content">
                                        <p><strong>Cholesterol Trajectory:</strong> 13% increase over 6 months (220‚Üí248 mg/dL)</p>
                                        <p><strong>Statin Resistance:</strong> Despite atorvastatin since May 15, levels continue rising</p>
                                        <p><strong>Compounding Factors:</strong> Reduced activity from anemia may worsen lipid profile</p>
                                    </div>
                                </div>

                                <div class="insight-card info">
                                    <div class="insight-header">üîç Timeline Correlation Analysis</div>
                                    <div class="insight-content">
                                        <p><strong>Symptom Onset:</strong> Patient fatigue complaints began ~April (correlates with Hgb <11.5)</p>
                                        <p><strong>Critical Threshold:</strong> Joint pain emerged when ferritin likely fell below 15 ng/mL (May-June)</p>
                                        <p><strong>Predictive Value:</strong> Current trajectory suggests ferritin <5 ng/mL without intervention</p>
                                    </div>
                                </div>
                            </div>

                            <div class="prognosis-section">
                                <h4>üìä Prognostic Modeling & Next Steps</h4>
                                <div class="prognosis-grid">
                                    <div class="prognosis-item">
                                        <strong>Iron Recovery Timeline:</strong>
                                        <p>With current therapy (325mg daily), expect 4-6 weeks for symptom improvement, 3-6 months for complete iron store replenishment</p>
                                    </div>
                                    <div class="prognosis-item">
                                        <strong>Risk Stratification:</strong>
                                        <p>High risk for cardiac complications if Hgb falls below 10 g/dL - consider IV iron if no response in 4 weeks</p>
                                    </div>
                                    <div class="prognosis-item">
                                        <strong>Monitoring Schedule:</strong>
                                        <p>CBC weekly x2, then monthly. Investigate source of iron loss if no improvement by 8 weeks</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Expandable Section Management
        function toggleExpand(sectionId) {
            const content = document.getElementById(sectionId);
            const toggle = content.previousElementSibling;

            if (content.classList.contains('active')) {
                content.classList.remove('active');
                toggle.classList.remove('active');
            } else {
                content.classList.add('active');
                toggle.classList.add('active');

                // Initialize charts when sections are expanded
                setTimeout(() => {
                    if (sectionId === 'symptom-tracking') {
                        initSymptomChart();
                    } else if (sectionId === 'wearables-data') {
                        initWearablesChart();
                    } else if (sectionId === 'health-trends') {
                        initTrendsChart();
                    }
                }, 300); // Wait for animation to complete
            }
        }

        // Voice Notes Integration (Placeholder)
        function startVoiceNote() {
            // Placeholder for voice notes functionality
            alert('Voice notes feature would integrate with speech-to-text API');
        }

        // Quick Actions (Placeholders)
        function orderLabs() {
            alert('Lab ordering interface would open here');
        }

        function prescribeMedication() {
            alert('Prescription interface would open here');
        }

        function scheduleFollowup() {
            alert('Scheduling interface would open here');
        }

        // Chart Initialization Functions
        let symptomChart, wearablesChart, trendsChart;

        function initSymptomChart() {
            if (symptomChart) return; // Already initialized

            const ctx = document.getElementById('symptomChart');
            if (!ctx) return;

            symptomChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jul 21', 'Jul 22', 'Jul 23', 'Jul 24', 'Jul 25', 'Jul 26', 'Jul 27'],
                    datasets: [{
                        label: 'Fatigue Level',
                        data: [7, 6, 8, 6, 5, 6, 6],
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Headache Intensity',
                        data: [3, 4, 5, 3, 4, 4, 4],
                        borderColor: '#f39c12',
                        backgroundColor: 'rgba(243, 156, 18, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Dizziness',
                        data: [2, 3, 4, 2, 3, 3, 3],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Joint Pain',
                        data: [8, 7, 8, 7, 6, 7, 7],
                        borderColor: '#9b59b6',
                        backgroundColor: 'rgba(155, 89, 182, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Symptom Severity Trends (Last 7 Days)',
                            font: { size: 16, weight: 'bold' },
                            color: '#2c3e50'
                        },
                        legend: {
                            position: 'bottom',
                            labels: { color: '#2c3e50', font: { size: 12 } }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 10,
                            title: {
                                display: true,
                                text: 'Severity (0-10)',
                                color: '#2c3e50'
                            },
                            ticks: { color: '#2c3e50' },
                            grid: { color: 'rgba(44, 62, 80, 0.1)' }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Date',
                                color: '#2c3e50'
                            },
                            ticks: { color: '#2c3e50' },
                            grid: { color: 'rgba(44, 62, 80, 0.1)' }
                        }
                    }
                }
            });
        }

        function initWearablesChart() {
            if (wearablesChart) return; // Already initialized

            const ctx = document.getElementById('wearablesChart');
            if (!ctx) return;

            wearablesChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jul 21', 'Jul 22', 'Jul 23', 'Jul 24', 'Jul 25', 'Jul 26', 'Jul 27'],
                    datasets: [{
                        label: 'Sleep Quality (%)',
                        data: [72, 68, 75, 70, 73, 71, 74],
                        borderColor: '#9b59b6',
                        backgroundColor: 'rgba(155, 89, 182, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y'
                    }, {
                        label: 'Daily Steps (thousands)',
                        data: [4.2, 3.8, 4.5, 4.1, 4.3, 4.0, 4.4],
                        borderColor: '#27ae60',
                        backgroundColor: 'rgba(39, 174, 96, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y1'
                    }, {
                        label: 'Avg Heart Rate (bpm)',
                        data: [78, 82, 76, 80, 79, 81, 77],
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y2'
                    }, {
                        label: 'HRV Score',
                        data: [42, 38, 45, 40, 43, 41, 44],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y3'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Wearable Device Metrics (Last 7 Days)',
                            font: { size: 16, weight: 'bold' },
                            color: '#2c3e50'
                        },
                        legend: {
                            position: 'bottom',
                            labels: { color: '#2c3e50', font: { size: 12 } }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Date',
                                color: '#2c3e50'
                            },
                            ticks: { color: '#2c3e50' },
                            grid: { color: 'rgba(44, 62, 80, 0.1)' }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Sleep Quality (%)',
                                color: '#9b59b6'
                            },
                            ticks: { color: '#9b59b6' },
                            grid: { color: 'rgba(155, 89, 182, 0.1)' }
                        },
                        y1: {
                            type: 'linear',
                            display: false,
                            position: 'right'
                        },
                        y2: {
                            type: 'linear',
                            display: false,
                            position: 'right'
                        },
                        y3: {
                            type: 'linear',
                            display: false,
                            position: 'right'
                        }
                    }
                }
            });
        }

        function initTrendsChart() {
            if (trendsChart) return; // Already initialized

            const ctx = document.getElementById('trendsChart');
            if (!ctx) return;

            trendsChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan 2025', 'Feb 2025', 'Mar 2025', 'Apr 2025', 'May 2025', 'Jun 2025', 'Jul 2025'],
                    datasets: [{
                        label: 'Hemoglobin (g/dL)',
                        data: [12.1, 11.8, 11.5, 11.2, 10.9, 10.6, 10.8],
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y'
                    }, {
                        label: 'Iron (Œºg/dL)',
                        data: [65, 62, 58, 54, 50, 47, 45],
                        borderColor: '#f39c12',
                        backgroundColor: 'rgba(243, 156, 18, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y1'
                    }, {
                        label: 'Ferritin (ng/mL)',
                        data: [25, 22, 18, 15, 12, 9, 8],
                        borderColor: '#9b59b6',
                        backgroundColor: 'rgba(155, 89, 182, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y2'
                    }, {
                        label: 'Total Cholesterol (mg/dL)',
                        data: [220, 225, 230, 235, 242, 245, 248],
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y3'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: '6-Month Health Trends - Key Biomarkers',
                            font: { size: 16, weight: 'bold' },
                            color: '#2c3e50'
                        },
                        legend: {
                            position: 'bottom',
                            labels: { color: '#2c3e50', font: { size: 12 } }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Month',
                                color: '#2c3e50'
                            },
                            ticks: { color: '#2c3e50' },
                            grid: { color: 'rgba(44, 62, 80, 0.1)' }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Hemoglobin (g/dL)',
                                color: '#e74c3c'
                            },
                            ticks: { color: '#e74c3c' },
                            grid: { color: 'rgba(231, 76, 60, 0.1)' }
                        },
                        y1: {
                            type: 'linear',
                            display: false,
                            position: 'right'
                        },
                        y2: {
                            type: 'linear',
                            display: false,
                            position: 'right'
                        },
                        y3: {
                            type: 'linear',
                            display: false,
                            position: 'right'
                        }
                    }
                }
            });
        }

        // NOTE: Tab system converted to expandable sections
        // MobileTabManager class kept for compatibility but no longer used
        class MobileTabManager {
            constructor() {
                this.currentActiveTab = 'lab-results';
                this.touchStartTime = 0;
                this.touchStartX = 0;
                this.touchStartY = 0;
                this.isTouch = false;
                this.init();
            }

            init() {
                this.bindEvents();
                this.preventDoubleClick();
                this.initializeQuickActions();
                this.initSwipeNavigation();
            }

            // Add swipe navigation between tabs
            initSwipeNavigation() {
                const tabContainer = document.querySelector('.main-grid');
                let startX = 0;
                let startY = 0;

                tabContainer.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].clientX;
                    startY = e.touches[0].clientY;
                }, { passive: true });

                tabContainer.addEventListener('touchend', (e) => {
                    const endX = e.changedTouches[0].clientX;
                    const endY = e.changedTouches[0].clientY;
                    const deltaX = endX - startX;
                    const deltaY = endY - startY;

                    // Only process horizontal swipes
                    if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
                        const tabs = ['lab-results', 'symptoms', 'wearables', 'trends'];
                        const currentIndex = tabs.indexOf(this.currentActiveTab);

                        if (deltaX > 0 && currentIndex > 0) {
                            // Swipe right - previous tab
                            this.switchTab(tabs[currentIndex - 1]);
                        } else if (deltaX < 0 && currentIndex < tabs.length - 1) {
                            // Swipe left - next tab
                            this.switchTab(tabs[currentIndex + 1]);
                        }
                    }
                }, { passive: true });
            }

            initializeQuickActions() {
                // Bind quick action buttons
                const quickActions = document.querySelectorAll('.quick-action-btn');
                quickActions.forEach((btn, index) => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        switch(index) {
                            case 0: orderLabs(); break;
                            case 1: prescribeMedication(); break;
                            case 2: scheduleFollowup(); break;
                            case 3: startVoiceNote(); break;
                        }
                    });
                });
            }

            bindEvents() {
                const tabs = document.querySelectorAll('.tab');
                
                tabs.forEach(tab => {
                    // Touch Events
                    tab.addEventListener('touchstart', this.handleTouchStart.bind(this), { passive: false });
                    tab.addEventListener('touchmove', this.handleTouchMove.bind(this), { passive: false });
                    tab.addEventListener('touchend', this.handleTouchEnd.bind(this), { passive: false });
                    tab.addEventListener('touchcancel', this.handleTouchCancel.bind(this), { passive: false });
                    
                    // Mouse Events (for desktop compatibility)
                    tab.addEventListener('click', this.handleClick.bind(this), { passive: false });
                    
                    // Prevent context menu on long press
                    tab.addEventListener('contextmenu', (e) => e.preventDefault());
                });
            }

            handleTouchStart(e) {
                e.preventDefault();
                this.isTouch = true;
                this.touchStartTime = Date.now();
                this.touchStartX = e.touches[0].clientX;
                this.touchStartY = e.touches[0].clientY;
                
                const tab = e.currentTarget;
                tab.classList.add('touching');
                
                // Add haptic feedback if available
                if (navigator.vibrate) {
                    navigator.vibrate(10);
                }
            }

            handleTouchMove(e) {
                if (!this.isTouch) return;
                
                const currentX = e.touches[0].clientX;
                const currentY = e.touches[0].clientY;
                const deltaX = Math.abs(currentX - this.touchStartX);
                const deltaY = Math.abs(currentY - this.touchStartY);
                
                // If user is scrolling/swiping, cancel the touch
                if (deltaX > 10 || deltaY > 10) {
                    this.handleTouchCancel(e);
                }
            }

            handleTouchEnd(e) {
                e.preventDefault();
                
                if (!this.isTouch) return;
                
                const tab = e.currentTarget;
                const touchDuration = Date.now() - this.touchStartTime;
                const tabId = tab.getAttribute('data-tab');
                
                // Remove touch state
                tab.classList.remove('touching');
                
                // Only trigger if it was a quick tap (not a long press)
                if (touchDuration < 500) {
                    this.switchTab(tabId, tab);
                }
                
                this.isTouch = false;
            }

            handleTouchCancel(e) {
                const tab = e.currentTarget;
                tab.classList.remove('touching');
                this.isTouch = false;
            }

            handleClick(e) {
                // Prevent duplicate events if touch was already handled
                if (this.isTouch) {
                    e.preventDefault();
                    return;
                }
                
                const tab = e.currentTarget;
                const tabId = tab.getAttribute('data-tab');
                this.switchTab(tabId, tab);
            }

            switchTab(tabId, clickedTab) {
                try {
                    console.log('Switching to tab:', tabId);

                    // Prevent switching to the same tab
                    if (tabId === this.currentActiveTab) {
                        console.log('Already on tab:', tabId);
                        return;
                    }

                    // Hide all tab contents
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                        content.style.display = 'none';
                    });

                    // Remove active from all tabs
                    document.querySelectorAll('.tab').forEach(tab => {
                        tab.classList.remove('active');
                    });

                    // Show selected tab content
                    const tabContent = document.getElementById(tabId);
                    if (tabContent) {
                        tabContent.classList.add('active');
                        tabContent.style.display = 'block';
                        tabContent.style.visibility = 'visible';
                        tabContent.style.opacity = '1';
                        console.log('Tab content shown for:', tabId);

                        // Force reflow to ensure content is rendered
                        tabContent.offsetHeight;

                        // Check if content is actually visible
                        const computedStyle = window.getComputedStyle(tabContent);
                        console.log(`Tab ${tabId} computed display:`, computedStyle.display);
                        console.log(`Tab ${tabId} computed visibility:`, computedStyle.visibility);
                    } else {
                        console.error('Tab content not found for:', tabId);
                    }

                    // Mark clicked tab as active
                    if (clickedTab) {
                        clickedTab.classList.add('active');
                    } else {
                        // Find and activate the correct tab button
                        const tabButton = document.querySelector(`[data-tab="${tabId}"]`);
                        if (tabButton) {
                            tabButton.classList.add('active');
                        }
                    }

                    // Update current active tab
                    this.currentActiveTab = tabId;

                    // Initialize charts when tabs are shown
                    this.initializeTabContent(tabId);

                    // Scroll to top of tab content on mobile
                    if (window.innerWidth <= 768 && tabContent) {
                        tabContent.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }

                    // Add haptic feedback for successful tab switch
                    if (navigator.vibrate) {
                        navigator.vibrate(20);
                    }

                } catch (error) {
                    console.error('Tab switching error:', error);
                }
            }

            initializeTabContent(tabId) {
                // Add a small delay to ensure the tab is visible before initializing charts
                setTimeout(() => {
                    switch(tabId) {
                        case 'symptoms':
                            this.initSymptomsChart();
                            break;
                        case 'wearables':
                            this.initWearablesChart();
                            break;
                        case 'trends':
                            this.initTrendsChart();
                            break;
                    }
                }, 100);
            }

            preventDoubleClick() {
                // Prevent double-tap zoom on tabs
                document.querySelectorAll('.tab').forEach(tab => {
                    let lastTouchEnd = 0;
                    tab.addEventListener('touchend', function(e) {
                        const now = (new Date()).getTime();
                        if (now - lastTouchEnd <= 300) {
                            e.preventDefault();
                        }
                        lastTouchEnd = now;
                    }, false);
                });
            }

            // Chart initialization methods
            initSymptomsChart() {
                try {
                    console.log('Initializing symptoms chart...');
                    const ctx = document.getElementById('symptomsChart');
                    if (!ctx) {
                        console.error('Symptoms chart canvas not found');
                        return;
                    }
                    if (!window.Chart) {
                        console.error('Chart.js not loaded');
                        return;
                    }

                    // Destroy existing chart if it exists
                    if (window.symptomsChartInstance) {
                        window.symptomsChartInstance.destroy();
                    }
                    
                    window.symptomsChartInstance = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['Jul 22', 'Jul 23', 'Jul 24', 'Jul 25', 'Jul 26', 'Jul 27', 'Jul 28'],
                            datasets: [{
                                label: 'Fatigue',
                                data: [4, 5, 6, 7, 6, 7, 6],
                                borderColor: '#e74c3c',
                                backgroundColor: 'rgba(231, 76, 60, 0.1)',
                                tension: 0.4
                            }, {
                                label: 'Headaches',
                                data: [3, 4, 4, 5, 4, 4, 4],
                                borderColor: '#f39c12',
                                backgroundColor: 'rgba(243, 156, 18, 0.1)',
                                tension: 0.4
                            }, {
                                label: 'Joint Pain',
                                data: [5, 6, 6, 7, 7, 8, 7],
                                borderColor: '#9b59b6',
                                backgroundColor: 'rgba(155, 89, 182, 0.1)',
                                tension: 0.4
                            }, {
                                label: 'Dizziness',
                                data: [4, 4, 3, 3, 2, 3, 3],
                                borderColor: '#3498db',
                                backgroundColor: 'rgba(52, 152, 219, 0.1)',
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'top',
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    max: 10,
                                    title: {
                                        display: true,
                                        text: 'Severity (0-10)'
                                    }
                                }
                            }
                        }
                    });
                    console.log('Symptoms chart created successfully');
                } catch (error) {
                    console.error('Symptoms chart initialization error:', error);
                }
            }

            initWearablesChart() {
                try {
                    const ctx = document.getElementById('wearablesChart');
                    if (!ctx || !window.Chart) return;
                    
                    // Destroy existing chart if it exists
                    if (window.wearablesChartInstance) {
                        window.wearablesChartInstance.destroy();
                    }
                    
                    window.wearablesChartInstance = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['Jul 22', 'Jul 23', 'Jul 24', 'Jul 25', 'Jul 26', 'Jul 27', 'Jul 28'],
                            datasets: [{
                                label: 'Daily Steps (thousands)',
                                data: [6.2, 5.8, 5.1, 4.7, 4.2, 4.8, 4.6],
                                borderColor: '#11998e',
                                backgroundColor: 'rgba(17, 153, 142, 0.1)',
                                tension: 0.4,
                                yAxisID: 'y'
                            }, {
                                label: 'Sleep Hours',
                                data: [6.5, 6.2, 5.8, 5.5, 4.9, 5.1, 5.2],
                                borderColor: '#4e54c8',
                                backgroundColor: 'rgba(78, 84, 200, 0.1)',
                                tension: 0.4,
                                yAxisID: 'y1'
                            }, {
                                label: 'Resting HR (bpm)',
                                data: [72, 74, 75, 76, 78, 77, 78],
                                borderColor: '#fc466b',
                                backgroundColor: 'rgba(252, 70, 107, 0.1)',
                                tension: 0.4,
                                yAxisID: 'y2'
                            }, {
                                label: 'HRV (ms)',
                                data: [35, 32, 30, 29, 27, 28, 28],
                                borderColor: '#3b41c5',
                                backgroundColor: 'rgba(59, 65, 197, 0.1)',
                                tension: 0.4,
                                yAxisID: 'y3'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                mode: 'index',
                                intersect: false,
                            },
                            plugins: {
                                legend: {
                                    position: 'top',
                                }
                            },
                            scales: {
                                x: {
                                    display: true,
                                    title: {
                                        display: true,
                                        text: 'Date'
                                    }
                                },
                                y: {
                                    type: 'linear',
                                    display: true,
                                    position: 'left',
                                    title: {
                                        display: true,
                                        text: 'Steps (thousands)'
                                    },
                                    min: 0,
                                    max: 10
                                },
                                y1: {
                                    type: 'linear',
                                    display: false,
                                    position: 'right',
                                    min: 0,
                                    max: 10
                                },
                                y2: {
                                    type: 'linear',
                                    display: false,
                                    position: 'right',
                                    min: 60,
                                    max: 90
                                },
                                y3: {
                                    type: 'linear',
                                    display: false,
                                    position: 'right',
                                    min: 20,
                                    max: 40
                                }
                            }
                        }
                    });
                } catch (error) {
                    console.error('Wearables chart initialization error:', error);
                }
            }

            initTrendsChart() {
                try {
                    const ctx = document.getElementById('trendsChart');
                    if (!ctx || !window.Chart) return;
                    
                    // Destroy existing chart if it exists
                    if (window.trendsChartInstance) {
                        window.trendsChartInstance.destroy();
                    }
                    
                    window.trendsChartInstance = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul'],
                            datasets: [{
                                label: 'Hemoglobin (g/dL)',
                                data: [12.1, 11.8, 11.5, 11.2, 10.9, 10.8],
                                borderColor: '#e74c3c',
                                backgroundColor: 'rgba(231, 76, 60, 0.1)',
                                tension: 0.4,
                                yAxisID: 'y'
                            }, {
                                label: 'Iron (Œºg/dL) √∑ 10',
                                data: [6.5, 5.8, 5.2, 4.8, 4.6, 4.5],
                                borderColor: '#f39c12',
                                backgroundColor: 'rgba(243, 156, 18, 0.1)',
                                tension: 0.4,
                                yAxisID: 'y'
                            }, {
                                label: 'Cholesterol (mg/dL)',
                                data: [220, 225, 230, 238, 245, 248],
                                borderColor: '#8e44ad',
                                backgroundColor: 'rgba(142, 68, 173, 0.1)',
                                tension: 0.4,
                                yAxisID: 'y1'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                mode: 'index',
                                intersect: false,
                            },
                            plugins: {
                                legend: {
                                    position: 'top',
                                }
                            },
                            scales: {
                                x: {
                                    display: true,
                                    title: {
                                        display: true,
                                        text: 'Month'
                                    }
                                },
                                y: {
                                    type: 'linear',
                                    display: true,
                                    position: 'left',
                                    title: {
                                        display: true,
                                        text: 'Hemoglobin (g/dL) ‚Ä¢ Iron (Œºg/dL) √∑ 10'
                                    },
                                    min: 4,
                                    max: 16
                                },
                                y1: {
                                    type: 'linear',
                                    display: true,
                                    position: 'right',
                                    title: {
                                        display: true,
                                        text: 'Cholesterol (mg/dL)'
                                    },
                                    min: 150,
                                    max: 300,
                                    grid: {
                                        drawOnChartArea: false,
                                    }
                                }
                            }
                        }
                    });
                } catch (error) {
                    console.error('Trends chart initialization error:', error);
                }
            }
        }

        // Initialize the mobile tab manager when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Initialize the mobile-friendly tab system
                window.mobileTabManager = new MobileTabManager();

                // Ensure the default tab is properly shown
                setTimeout(() => {
                    console.log('Initializing default tab...');
                    const defaultTab = document.querySelector('.tab.active');
                    const defaultTabId = defaultTab ? defaultTab.getAttribute('data-tab') : 'lab-results';
                    console.log('Default tab ID:', defaultTabId);

                    // Make sure the default tab content is visible
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.style.display = 'none';
                        content.classList.remove('active');
                        console.log('Hiding tab content:', content.id);
                    });

                    const defaultContent = document.getElementById(defaultTabId);
                    if (defaultContent) {
                        defaultContent.style.display = 'block';
                        defaultContent.classList.add('active');
                        console.log('Showing default tab content:', defaultTabId);
                    } else {
                        console.error('Default tab content not found:', defaultTabId);
                    }

                    window.mobileTabManager.currentActiveTab = defaultTabId;

                    // Add fallback click handlers for tabs in case mobile manager fails
                    document.querySelectorAll('.tab').forEach(tabButton => {
                        tabButton.addEventListener('click', function(e) {
                            const tabId = this.getAttribute('data-tab');
                            console.log('Fallback tab click:', tabId);

                            if (window.mobileTabManager) {
                                window.mobileTabManager.switchTab(tabId, this);
                            } else {
                                // Direct fallback if mobile manager not available
                                testTabSwitch(tabId);
                            }
                        });
                    });

                    // Test all tab contents exist
                    const expectedTabs = ['lab-results', 'symptoms', 'wearables', 'trends'];
                    expectedTabs.forEach(tabId => {
                        const tabContent = document.getElementById(tabId);
                        const tabButton = document.querySelector(`[data-tab="${tabId}"]`);
                        console.log(`Tab ${tabId}: Content=${!!tabContent}, Button=${!!tabButton}`);

                        if (tabContent) {
                            console.log(`Tab ${tabId} content classes:`, tabContent.className);
                            console.log(`Tab ${tabId} content style:`, tabContent.style.display);
                        }
                    });

                    // Test symptoms tab specifically
                    const symptomsTab = document.getElementById('symptoms');
                    if (symptomsTab) {
                        console.log('Symptoms tab found, children count:', symptomsTab.children.length);
                        const symptomsGrid = symptomsTab.querySelector('.symptoms-grid');
                        if (symptomsGrid) {
                            console.log('Symptoms grid found, children count:', symptomsGrid.children.length);
                            // Check each symptom card
                            const symptomCards = symptomsGrid.querySelectorAll('.symptom-card');
                            console.log('Symptom cards found:', symptomCards.length);
                            symptomCards.forEach((card, index) => {
                                console.log(`Symptom card ${index}:`, card.textContent.trim());
                            });
                        } else {
                            console.error('Symptoms grid not found');
                        }
                    }

                    // Test wearables tab specifically
                    const wearablesTab = document.getElementById('wearables');
                    if (wearablesTab) {
                        console.log('Wearables tab found, children count:', wearablesTab.children.length);
                        const wearablesGrid = wearablesTab.querySelector('.wearable-metric-grid');
                        if (wearablesGrid) {
                            console.log('Wearables grid found, children count:', wearablesGrid.children.length);
                            // Check each wearable card
                            const wearableCards = wearablesGrid.querySelectorAll('.wearable-card');
                            console.log('Wearable cards found:', wearableCards.length);
                            wearableCards.forEach((card, index) => {
                                console.log(`Wearable card ${index}:`, card.textContent.trim());
                            });
                        } else {
                            console.error('Wearables grid not found');
                        }
                    }
                }, 100);

                // Add interactive effects for cards with error handling
                try {
                    const cards = document.querySelectorAll('.card');
                    console.log('Found cards for interaction:', cards.length);

                    cards.forEach((card, index) => {
                        try {
                            // Mouse events for desktop
                            card.addEventListener('mouseenter', function() {
                                if (window.innerWidth > 768) { // Only on desktop
                                    this.style.transform = 'translateY(-4px)';
                                }
                            });

                            card.addEventListener('mouseleave', function() {
                                if (window.innerWidth > 768) { // Only on desktop
                                    this.style.transform = 'translateY(0)';
                                }
                            });

                            // Touch events for mobile/tablet
                            card.addEventListener('touchstart', function() {
                                if (window.innerWidth <= 768) {
                                    this.style.transform = 'scale(0.98)';
                                }
                            });

                            card.addEventListener('touchend', function() {
                                if (window.innerWidth <= 768) {
                                    this.style.transform = 'scale(1)';
                                }
                            });

                        } catch (cardError) {
                            console.warn(`Error adding events to card ${index}:`, cardError);
                        }
                    });
                } catch (error) {
                    console.warn('Error setting up card interactions:', error);
                }

                // Animate progress bars with error handling
                try {
                    const progressBars = document.querySelectorAll('.progress-fill');
                    console.log('Found progress bars:', progressBars.length);

                    progressBars.forEach((bar, index) => {
                        try {
                            const width = bar.style.width;
                            bar.style.width = '0%';
                            setTimeout(() => {
                                bar.style.width = width;
                            }, 500);
                        } catch (barError) {
                            console.warn(`Error animating progress bar ${index}:`, barError);
                        }
                    });
                } catch (error) {
                    console.warn('Error setting up progress bar animations:', error);
                }

                // Add orientation change handler for mobile with error handling
                try {
                    window.addEventListener('orientationchange', function() {
                        setTimeout(() => {
                            try {
                                // Trigger chart resize if needed
                                if (window.symptomsChartInstance) {
                                    window.symptomsChartInstance.resize();
                                    console.log('Resized symptoms chart');
                                }
                                if (window.wearablesChartInstance) {
                                    window.wearablesChartInstance.resize();
                                    console.log('Resized wearables chart');
                                }
                                if (window.trendsChartInstance) {
                                    window.trendsChartInstance.resize();
                                    console.log('Resized trends chart');
                                }
                            } catch (resizeError) {
                                console.warn('Error resizing charts on orientation change:', resizeError);
                            }
                        }, 500);
                    });
                } catch (error) {
                    console.warn('Error setting up orientation change handler:', error);
                }

            } catch (error) {
                console.error('Dashboard initialization error:', error);
            }
        });

        // Add keyboard navigation for accessibility
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
                const tabs = ['lab-results', 'symptoms', 'wearables', 'trends'];
                const activeTab = document.querySelector('.tab.active');
                if (!activeTab) return;

                const currentIndex = tabs.indexOf(activeTab.dataset.tab);

                if (e.key === 'ArrowLeft' && currentIndex > 0) {
                    document.querySelector(`[data-tab="${tabs[currentIndex - 1]}"]`).click();
                } else if (e.key === 'ArrowRight' && currentIndex < tabs.length - 1) {
                    document.querySelector(`[data-tab="${tabs[currentIndex + 1]}"]`).click();
                }
            }
        });

        // Add visual feedback for critical values
        const criticalValueStyle = document.createElement('style');
        criticalValueStyle.textContent = `
            @keyframes pulse {
                0% { opacity: 1; }
                50% { opacity: 0.7; }
                100% { opacity: 1; }
            }

            .value-high, .value-low {
                font-weight: 700;
                text-shadow: 0 0 3px rgba(0,0,0,0.3);
                animation: pulse 2s infinite;
            }

            .critical-value-item {
                animation: fadeInUp 0.6s ease-out;
            }

            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        `;
        document.head.appendChild(criticalValueStyle);

        // Legacy function for backward compatibility
        function showTab(tabId, element) {
            console.warn('showTab() is deprecated. Using new mobile tab manager.');
            if (window.mobileTabManager) {
                window.mobileTabManager.switchTab(tabId, element);
            }
        }

        // Debug function to manually test tab switching
        function testTabSwitch(tabId) {
            console.log('Manual tab switch test for:', tabId);

            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'none';
                content.classList.remove('active');
            });

            // Show target tab
            const targetTab = document.getElementById(tabId);
            if (targetTab) {
                targetTab.style.display = 'block';
                targetTab.classList.add('active');
                console.log('Manually showed tab:', tabId);

                // Update tab buttons
                document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
                const tabButton = document.querySelector(`[data-tab="${tabId}"]`);
                if (tabButton) {
                    tabButton.classList.add('active');
                }
            } else {
                console.error('Tab not found:', tabId);
            }
        }

        // Make test function globally available
        window.testTabSwitch = testTabSwitch;

        // Debug function to show all tab content at once
        function showAllTabs() {
            console.log('Showing all tabs for debugging...');
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'block';
                content.style.visibility = 'visible';
                content.style.opacity = '1';
                content.classList.add('active');
                console.log('Forced visible:', content.id);
            });
        }

        window.showAllTabs = showAllTabs;

        // Force show symptoms content specifically
        function forceShowSymptoms() {
            console.log('Force showing symptoms content...');
            const symptomsTab = document.getElementById('symptoms');
            if (symptomsTab) {
                // Force all possible visibility styles
                symptomsTab.style.display = 'block';
                symptomsTab.style.visibility = 'visible';
                symptomsTab.style.opacity = '1';
                symptomsTab.style.position = 'relative';
                symptomsTab.style.zIndex = '10';
                symptomsTab.style.width = '100%';
                symptomsTab.style.height = 'auto';
                symptomsTab.style.minHeight = '500px';
                symptomsTab.style.overflow = 'visible';
                symptomsTab.style.backgroundColor = 'rgba(255, 0, 0, 0.1)'; // Red background for debugging
                symptomsTab.classList.add('active');

                // Force show the symptoms grid
                const symptomsGrid = symptomsTab.querySelector('.symptoms-grid');
                if (symptomsGrid) {
                    symptomsGrid.style.display = 'grid';
                    symptomsGrid.style.visibility = 'visible';
                    symptomsGrid.style.opacity = '1';
                    symptomsGrid.style.backgroundColor = 'rgba(0, 255, 0, 0.1)'; // Green background for debugging

                    // Force show each symptom card
                    const cards = symptomsGrid.querySelectorAll('.symptom-card');
                    cards.forEach((card, index) => {
                        card.style.display = 'flex';
                        card.style.visibility = 'visible';
                        card.style.opacity = '1';
                        card.style.backgroundColor = card.style.backgroundColor || '#667eea'; // Ensure background
                        console.log(`Forced symptom card ${index} visible`);
                    });
                }

                console.log('Symptoms content forced visible with debug backgrounds');
            }
        }

        window.forceShowSymptoms = forceShowSymptoms;
    </script>
</body>
</html>